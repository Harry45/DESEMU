Sampling dimensions 160
  0%|                                                                                                        | 0/15500 [00:00<?, ?it/s]2024-01-31 10:57:04.628868: E external/org_tensorflow/tensorflow/compiler/xla/stream_executor/cuda/cuda_driver.cc:1159] failed to enqueue async memcpy from device to host: CUDA_ERROR_ILLEGAL_ADDRESS: an illegal memory access was encountered; host dst: 0x7ffda89e45ef; GPU src: 0x7f952a77eb00; size: 1=0x1
2024-01-31 10:57:04.629087: E external/org_tensorflow/tensorflow/compiler/xla/pjrt/pjrt_stream_executor_client.cc:2153] Execution of replica 0 failed: INTERNAL: Failed to complete all kernels launched on stream 0x3159130: stream did not block host until done; was already in an error state
  0%|                                                                                                        | 0/15500 [01:36<?, ?it/s]
Traceback (most recent call last):
  File "/mnt/zfsusers/phys2286/projects/DESEMU/test.py", line 151, in <module>
    main(dimensions, 0.01, 8, 500, 15000)
  File "/mnt/zfsusers/phys2286/projects/DESEMU/test.py", line 136, in main
    mcmc, nlike_nuts = run_nuts(stepsize, tree_depth, nwarmup, nsamples_nuts, d)
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/zfsusers/phys2286/projects/DESEMU/test.py", line 110, in run_nuts
    mcmc.run(
  File "/mnt/zfsusers/phys2286/anaconda3/envs/jaxcosmo/lib/python3.11/site-packages/numpyro/infer/mcmc.py", line 602, in run
    states, last_state = partial_map_fn(map_args)
                         ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/zfsusers/phys2286/anaconda3/envs/jaxcosmo/lib/python3.11/site-packages/numpyro/infer/mcmc.py", line 404, in _single_chain_mcmc
    collect_vals = fori_collect(
                   ^^^^^^^^^^^^^
  File "/mnt/zfsusers/phys2286/anaconda3/envs/jaxcosmo/lib/python3.11/site-packages/numpyro/util.py", line 358, in fori_collect
    vals = jit(_body_fn)(i, vals)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/zfsusers/phys2286/anaconda3/envs/jaxcosmo/lib/python3.11/site-packages/jax/_src/traceback_util.py", line 162, in reraise_with_filtered_traceback
    return fun(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^
  File "/mnt/zfsusers/phys2286/anaconda3/envs/jaxcosmo/lib/python3.11/site-packages/jax/_src/api.py", line 623, in cache_miss
    out_flat = call_bind_continuation(execute(*args_flat))
                                      ^^^^^^^^^^^^^^^^^^^
  File "/mnt/zfsusers/phys2286/anaconda3/envs/jaxcosmo/lib/python3.11/site-packages/jax/_src/dispatch.py", line 895, in _execute_compiled
    out_flat = compiled.execute(in_flat)
               ^^^^^^^^^^^^^^^^^^^^^^^^^
jax._src.traceback_util.UnfilteredStackTrace: jaxlib.xla_extension.XlaRuntimeError: INTERNAL: Failed to complete all kernels launched on stream 0x3159130: stream did not block host until done; was already in an error state

The stack trace below excludes JAX-internal frames.
The preceding is the original exception that occurred, unmodified.

--------------------

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/mnt/zfsusers/phys2286/projects/DESEMU/test.py", line 151, in <module>
    main(dimensions, 0.01, 8, 500, 15000)
  File "/mnt/zfsusers/phys2286/projects/DESEMU/test.py", line 136, in main
    mcmc, nlike_nuts = run_nuts(stepsize, tree_depth, nwarmup, nsamples_nuts, d)
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/zfsusers/phys2286/projects/DESEMU/test.py", line 110, in run_nuts
    mcmc.run(
  File "/mnt/zfsusers/phys2286/anaconda3/envs/jaxcosmo/lib/python3.11/site-packages/numpyro/infer/mcmc.py", line 602, in run
    states, last_state = partial_map_fn(map_args)
                         ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/zfsusers/phys2286/anaconda3/envs/jaxcosmo/lib/python3.11/site-packages/numpyro/infer/mcmc.py", line 404, in _single_chain_mcmc
    collect_vals = fori_collect(
                   ^^^^^^^^^^^^^
  File "/mnt/zfsusers/phys2286/anaconda3/envs/jaxcosmo/lib/python3.11/site-packages/numpyro/util.py", line 358, in fori_collect
    vals = jit(_body_fn)(i, vals)
           ^^^^^^^^^^^^^^^^^^^^^^
jaxlib.xla_extension.XlaRuntimeError: INTERNAL: Failed to complete all kernels launched on stream 0x3159130: stream did not block host until done; was already in an error state
2024-01-31 10:57:06.008150: E external/org_tensorflow/tensorflow/compiler/xla/stream_executor/cuda/cuda_driver.cc:1043] could not synchronize on CUDA context: CUDA_ERROR_ILLEGAL_ADDRESS: an illegal memory access was encountered :: *** Begin stack trace ***
















	_PyObject_MakeTpCall
	PyObject_CallOneArg

	PyObject_ClearWeakRefs



	_PyModule_ClearDict

	Py_FinalizeEx
	Py_RunMain
	Py_BytesMain
	__libc_start_main

*** End stack trace ***

2024-01-31 10:57:06.008236: F external/org_tensorflow/tensorflow/compiler/xla/service/gpu/gpu_executable.cc:150] Check failed: pair.first->SynchronizeAllActivity()
Aborted (core dumped)